<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="net.ounwan.coupung">
    <select id="selectAll" resultType="coupung">
    	SELECT * FROM COUPUNG WHERE AVAILABLE_CHECK = 1
    </select>
    
    <select id="selectAdminAll" resultType="coupung">
    	SELECT * FROM COUPUNG 
    </select>
    
    <select id="selectById" parameterType="int" resultType="coupung">
    	SELECT * FROM COUPUNG WHERE COUPUNG_CATEGORY_NUMBER = #{categoryId} AND AVAILABLE_CHECK = 1
    </select>
    
    <select id="selectDetail" parameterType="int" resultType="coupung">
    	SELECT * FROM COUPUNG WHERE COUPUNG_NUMBER = #{coupungId}
    </select>
    
    <select id="selectHotDeals" resultType="coupung">
    	SELECT * FROM COUPUNG WHERE COUPUNG_CATEGORY_NUMBER = 9
    </select>
    
    <select id="findByName" parameterType="String" resultType="coupung">
    	SELECT * FROM COUPUNG WHERE NAME LIKE CONCAT('%', #{text}, '%')
    </select>
    
    <insert id="insertProduct" parameterType="coupung" useGeneratedKeys="true" keyProperty="coupungNumber">
    	INSERT 
    	INTO COUPUNG (COUPUNG_CATEGORY_NUMBER, NAME, PRICE, AVAILABLE_STOCK, AVAILABLE_CHECK)
    	VALUES (#{coupungCategoryNumber}, #{name}, #{price}, #{availableStock}, TRUE)
    </insert>
    
    <update id="updateProduct" parameterType="coupung">
    	UPDATE COUPUNG
    	SET COUPUNG_CATEGORY_NUMBER = #{coupungCategoryNumber}
    		, NAME = #{name}
    		, PRICE = #{price}
    		, AVAILABLE_STOCK = #{availableStock}
    		, AVAILABLE_CHECK = #{availableCheck}
    	WHERE COUPUNG_NUMBER = #{coupungNumber}
    </update>
    
    <update id="deleteProduct" parameterType="int">
    	UPDATE COUPUNG
    	SET AVAILABLE_CHECK = FALSE
    	WHERE COUPUNG_NUMBER = #{coupungId}
    </update>
    
    <select id="getPrice" parameterType="int" resultType="int">
    	SELECT PRICE FROM COUPUNG 
    	WHERE COUPUNG_NUMBER = #{coupungNumber}
    </select>
</mapper>