<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="net.ounwan.somsomiChat">

	<!-- 방 여부 확인 -->
	<select id="selectRoomList" resultType="string">
		SELECT ROOM_ID FROM
		SOMSOMI_CHAT_ROOM
	</select>

	<select id="selectSomsomiChatList" resultType="somsomiChatMessage">
		select * from
		SOMSOMI_CHAT_MESSAGE WHERE ROOM_ID = #{roomId}
	</select>
	
	<insert id="makeRoom" parameterType="somsomiChatRoom">
		insert into SOMSOMI_CHAT_ROOM (ROOM_ID, ADMIN_ID, CLIENT_ID)
		value(#{roomId}, #{adminId}, #{clientId})
	</insert>
	
	<insert id="insertMessage">
		insert into SOMSOMI_CHAT_MESSAGE (ROOM_ID, SENDER, MESSAGE)
		values(#{roomId}, #{sender}, #{message})
	</insert>
	
	<select id="lastMessageId" resultType="int">
 		select max(message_id) from SOMSOMI_CHAT_MESSAGE where ROOM_ID = #{roomId}
 	</select>
 	
 	<delete id="deleteMessage">
		DELETE FROM SOMSOMI_CHAT_MESSAGE WHERE MESSAGE_ID = #{messageId}
	</delete>

</mapper>
